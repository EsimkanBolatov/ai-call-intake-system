# AI Call Intake System - 102 าัะทะผะตััะฝะต ะัะฝะฐะปาะฐะฝ ะะ-ะำฉะผะตะบัั

## ๐ฏ ะะะะะะซาข ะะาะกะะขะซ

ะะตะบะต ัะตะปะตัะพะฝ ะฝำฉะผัััะฝะต าะพาฃััะฐั าะฐะฑัะปะดะฐะนััะฝ, 102 ะฟะพะปะธัะธั าัะทะผะตััะฝะต ะฐัะฝะฐะปาะฐะฝ ะะ-ะบำฉะผะตะบััะฝัาฃ ัะพะปัา ะถาฑะผัั ัััะตะนััะฝ ะดะตะผะพ/MVP ะถาฏะนะตัั.

**โ๏ธ ะะาขะซะะะซ ะะกะะะะขะฃ:**

- ะาฑะป ะถะพะฑะฐ ัะตัะผะธ 102 ะตะผะตั
- ะขะตะบ ะถะตะบะต ะฝำฉะผััะณะต ะถาฑะผัั ัััะตะนะดั
- Demo/Pilot ะผะฐาัะฐััะฝะดะฐ
- ะะ ะฟะพะปะธัะธัะฝั ะฐะปะผะฐััััะผะฐะนะดั
- ะขะตะบ ะบำฉะผะตะบัั ัะตััะฝะดะต

## ๐ ะาฎะะะะะะะะขะะ

### ะะตะณัะทะณั ะผาฏะผะบัะฝะดัะบัะตั:

- โ **าะพาฃััะฐั าะฐะฑัะปะดะฐั** - ะะตะท ะบะตะปะณะตะฝ SIP ัะตะปะตัะพะฝะฝะฐะฝ าะพาฃััะฐั
- โ **ะะฒัะพ-ะถะฐัะฐะฟ** - 2-3 ัะตะบัะฝะด ัััะฝะดะต ะถะฐัะฐะฟ ะฑะตัะตะดั
- โ **ะะฐััััั ะผำััะฝะณะต ะฐะนะฝะฐะปะดััั** - Whisper ะฐัาัะปั (ะบะฐะทะฐา/ะพััั ััะปะดะตััะฝะดะต)
- โ **ะะ ัะฐะปะดะฐั** - OpenAI GPT-4/3.5 ะฐัาัะปั ะธะฝัะธะดะตะฝััั ัะฐะปะดะฐั
- โ **ะะปะฐััะธัะธะบะฐัะธั** - ะะฝัะธะดะตะฝััั ะบะฐัะตะณะพัะธัะปะฐัาะฐ ะฑำฉะปั
- โ **ะกัะพัะฝะพััั ะฐะฝัาัะฐั** - critical/high/medium/low
- โ **ะำััะฝะดั ะดะฐัััาะฐ ะฐะนะฝะฐะปะดััั** - Coqui/OpenAI TTS ะฐัาัะปั
- โ **ะะพะณัะฐั** - ะะฐัะปัา ะดะตัะตะบัะตัะดั ัะฐาัะฐั
- โ **Dashboard** - ะะตะฑ-ะธะฝัะตััะตะนั ะพะฟะตัะฐัะพัะปะฐั าฏััะฝ

### าะพััะผัะฐ ะผาฏะผะบัะฝะดัะบัะตั:

- ๐ **ะำฉะฟััะปะดัะปัะบ** - ะะฐะทะฐา ะถำะฝะต ะพััั ััะปะดะตััะฝ าะพะปะดะฐะนะดั
- ๐ก **าะฐััะฟััะทะดัะบ** - Rate limiting, ัะธััะปะฐั, ะผะฐัะบะธัะพะฒะบะฐ
- ๐ **ะัะตะฟัะตั** - ะาฏะฝะดะตะปัะบัั ะตัะตะฟัะตั, ััะฐัะธััะธะบะฐ
- ๐ **ะะฝัะตะณัะฐัะธั** - CRM ะถาฏะนะตะปะตััะผะตะฝ ะธะฝัะตะณัะฐัะธั
- ๐จ **ะัะบะตัััะปะตั** - Telegram/Email ะตัะบะตัััะปะตัั

## ๐ ะะะฅะะขะะะขะฃะะ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะขะะะซา ะะะฅะะขะะะขะฃะะ ะกะฅะะะะกะซ                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  [ะขะตะปะตัะพะฝ] โ [SIP Trunk] โ [Asterisk PBX] โ [AGI Script]   โ
โ                                                             โ
โ  [AGI Script] โ [Python Backend] โ [STT Service] โ [LLM]   โ
โ                                                             โ
โ  [LLM] โ [Classifier] โ [JSON Generator] โ [TTS Service]   โ
โ                                                             โ
โ  [TTS] โ [Asterisk] โ [ะขะตะปะตัะพะฝ] + [Logging] + [Dashboard]  โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะขะพะปัา ะฐััะธัะตะบัััะฐ ััะตะผะฐัั:** `docs/ARCHITECTURE_ASCII.md`

## ๐ ะขะะฅะะะะะะะฏะะะ

### ะะตะณัะทะณั ัะตัะฝะพะปะพะณะธัะปะฐั:

- **ะะ**: Ubuntu 20.04/22.04 LTS
- **ะขะตะปะตัะพะฝะธั**: Asterisk 18+
- **Backend**: Python 3.10+
- **STT**: OpenAI Whisper (offline/online)
- **LLM**: OpenAI GPT-4/3.5, DeepSeek
- **TTS**: Coqui TTS, OpenAI TTS
- **ะะฐะทะฐ ะดะฐะฝะฝัั**: SQLite (ำฉะฝะดัััั าฏััะฝ PostgreSQL)
- **Dashboard**: Flask + HTML/CSS/JS

### าะพััะผัะฐ าาฑัะฐะปะดะฐั:

- **ะะพะฝัะตะนะฝะตัะธะทะฐัะธั**: Docker (ะพะฟัะธัะปัา)
- **ะะพะฝะธัะพัะธะฝะณ**: Prometheus + Grafana (ะพะฟัะธัะปัา)
- **ะะพะณัะฐั**: Systemd Journal + ัะฐะนะป ะปะพะณัะฐัั
- **ะะตะทะตัะฒััะบ ะบำฉัััั**: ะะฒัะพะผะฐััั ะฝาฑัาะฐะปะฐั

## ๐ ะคะะะะะซา าาฐะะซะะซะ

```
ai-call-intake-system/
โโโ asterisk/                    # Asterisk ะบะพะฝัะธะณััะฐัะธััั
โ   โโโ config/
โ   โ   โโโ extensions.conf     # าะพาฃััะฐั ะปะพะณะธะบะฐัั
โ   โ   โโโ sip.conf           # SIP ะฑะฐะฟัะฐัะปะฐัั
โ   โ   โโโ asterisk.conf      # ะะตะณัะทะณั ะบะพะฝัะธะณััะฐัะธั
โ   โ   โโโ extensions_kazakh.conf # ะะฐะทะฐา ััะปัะฝะดะตะณั ะบะพะฝัะธะณััะฐัะธั
โ   โโโ README.md              # Asterisk าาฑะถะฐััะฐะผะฐัั
โโโ agi/                        # AGI ัะบัะธะฟัะตัั
โ   โโโ call_handler.py        # ะะตะณัะทะณั าะพาฃััะฐั ำฉาฃะดะตััั
โโโ services/                   # Python ัะตัะฒะธััะตัั
โ   โโโ stt_service.py         # Speech-to-Text
โ   โโโ llm_service.py         # Large Language Model
โ   โโโ tts_service.py         # Text-to-Speech
โ   โโโ classifier.py          # ะะฝัะธะดะตะฝั ะบะปะฐััะธัะธะบะฐัะพัั
โ   โโโ logger.py              # ะะพะณัะฐั ะถาฏะนะตัั
โโโ dashboard/                  # ะะตะฑ-ะธะฝัะตััะตะนั
โ   โโโ app.py                 # Flask าะพะปะดะฐะฝะฑะฐัั
โ   โโโ templates/
โ   โ   โโโ index.html         # HTML าฏะปะณััั
โ   โโโ static/                # CSS/JS ัะฐะนะปะดะฐัั
โโโ docs/                       # าาฑะถะฐััะฐะผะฐ
โ   โโโ ARCHITECTURE_ASCII.md  # ะััะธัะตะบัััะฐ ััะตะผะฐัั
โ   โโโ JSON_FORMAT.md         # JSON ะฟัััะผั
โ   โโโ EDGE_CASES.md          # Edge cases ำฉาฃะดะตั
โ   โโโ SECURITY_AND_LIMITS.md # าะฐััะฟััะทะดัะบ ะตัะตะถะตะปะตัั
โโโ scripts/                    # ะกะบัะธะฟัะตั
โ   โโโ install_kazakh.sh      # ะัะฝะฐัั ัะบัะธะฟัั
โ   โโโ manage_system.sh       # ะะฐัาะฐัั ัะบัะธะฟัั
โโโ ะคะะะะะะ:
    โโโ production.env         # ำจะฝะดัััั ะบะพะฝัะธะณััะฐัะธััั
    โโโ INSTALLATION_GUIDE.md  # ะัะฝะฐัั ะฝาฑัาะฐัะปัาั
    โโโ TESTING_GUIDE.md       # ะขะตัััะปะตั ะฝาฑัาะฐัะปัาั
    โโโ DEMONSTRATION_SCENARIO.md # ะะตะผะพ ััะตะฝะฐัะธะนะปะตัั
    โโโ MVP_COMPLETION_REPORT.md  # MVP ะฐัาัะฐะปั ะตัะตะฑั
    โโโ PROJECT_STRUCTURE.md   # ะขะพะปัา าาฑััะปัะผ
    โโโ README_KAZAKH.md       # ะาฑะป ัะฐะนะป
```

## ๐ ะาฎะะะะ ะะะะะขะฃ

### 1. ะัะปะดะฐะผ ะพัะฝะฐัั (ะฑัั ะบะพะผะฐะฝะดะฐ):

```bash
sudo bash install_kazakh.sh
```

### 2. าะพะปะผะตะฝ ะพัะฝะฐัั:

```bash
# 1. ะาฏะนะตะฝั ะถะฐาฃะฐััั
sudo apt update && sudo apt upgrade -y

# 2. Asterisk ะพัะฝะฐัั
sudo apt install -y asterisk

# 3. Python 3.10 ะพัะฝะฐัั
sudo apt install -y python3.10 python3.10-venv

# 4. ะัะพะตะบััั ะบะปะพะฝะดะฐั
git clone <repository-url>
cd ai-call-intake-system

# 5. Virtual environment ะถะฐัะฐั
python3.10 -m venv venv
source venv/bin/activate

# 6. ะขำฉะผะตะฝะดัะปัะบัะตัะดั ะพัะฝะฐัั
pip install -r requirements.txt

# 7. ะะพะฝัะธะณััะฐัะธัะปะฐัะดั ะบำฉัััั
sudo cp asterisk/config/* /etc/asterisk/
sudo cp agi/call_handler.py /var/lib/asterisk/agi-bin/
sudo chmod +x /var/lib/asterisk/agi-bin/call_handler.py

# 8. .env ัะฐะนะปัะฝ ะถะฐัะฐั
cp production.env .env
# API ะบัะปััะตััะฝ ำฉะทะณะตัััาฃัะท

# 9. Asterisk าะฐะนัะฐ ะถาฏะบัะตั
sudo systemctl restart asterisk
```

### 3. Docker ะฐัาัะปั ะพัะฝะฐัั (ะพะฟัะธัะปัา):

```bash
docker-compose -f deployment/docker-compose.yml up -d
```

## ๐ฎ ะาฎะะะะ ะะะกาะะะฃ

### ะะตะณัะทะณั ะฑะฐัาะฐัั ะบะพะผะฐะฝะดะฐะปะฐัั:

```bash
# ะะฐัะปัา ัะตัะฒะธััะตัะดั ะฑะฐััะฐั
sudo bash manage_system.sh start

# ะาฏะนะต ััะฐััััะฝ ัะตะบัะตัั
sudo bash manage_system.sh status

# ะขะตัั าะพาฃััะฐัั ะถัะฑะตัั
sudo bash manage_system.sh test

# ะะพะณัะฐัะดั ะบำฉัั
sudo bash manage_system.sh logs

# ะะตัะตะบัะตัะดั ะฝาฑัาะฐะปะฐั
sudo bash manage_system.sh backup

# ะาฏะนะตะฝั ะถะฐาฃะฐััั
sudo bash manage_system.sh update
```

### Systemd ะบะพะผะฐะฝะดะฐะปะฐัั:

```bash
# Asterisk ะฑะฐัาะฐัั
sudo systemctl start|stop|restart|status asterisk

# AI ัะตัะฒะธั ะฑะฐัาะฐัั
sudo systemctl start|stop|restart|status ai-call-intake

# Dashboard ะฑะฐัาะฐัั
sudo systemctl start|stop|restart|status ai-call-dashboard
```

## ๐ ะขะะกะขะะะะฃ

### ะขะตัั าะพาฃััะฐัะปะฐัั:

1. **ะัะบั ัะตัั:** `sudo asterisk -rx "channel originate SIP/500 extension 500@internal-test"`
2. **SIP ัะตะปะตัะพะฝ:** 500 ะฝำฉะผัััะฝะต าะพาฃััะฐั ัะฐะปัาฃัะท
3. **Python ัะบัะธะฟั:** `python test_call_emulation.py`

### ะขะตัั ััะตะฝะฐัะธะนะปะตัั:

```python
# test_scenarios.py
test_cases = [
    "ะะตะฝัาฃ ะผะฐัะธะฝะฐะผ าฑัะปะฐะฝะดั",
    "ะััะตั ะฟััะฐาะฟะตะฝ ัะฐะฑััะป ะถะฐัะฐะดั",
    "ะำฉัััะปะตั ะฐะนาะฐะนะปะฐััะฟ ะถะฐััั",
    "ะำฉะปัะบ ะฐะฟะฐัั ะฑะพะปะดั",
    "ำจัั ััาัั"
]
```

### Dashboard ัะตััั:

1. ะัะฐัะทะตัะดะต ะฐััาฃัะท: `http://localhost:5000`
2. ะััั ะดะตัะตะบัะตัั: admin / ChangeMe123!
3. าะพาฃััะฐัะปะฐั ััะทัะผัะฝ ัะตะบัะตััาฃัะท

## ๐ง ะะะะคะะะฃะะะฆะะฏ

### ะะตะณัะทะณั ะฑะฐะฟัะฐัะปะฐั (.env ัะฐะนะปั):

```env
# API ะบัะปััะตัั
OPENAI_API_KEY=sk-proj-ะฒะฐั-ะบะปัั
DEEPSEEK_API_KEY=sk-ะฒะฐั-ะบะปัั

# าะพะทาะฐะปัาัััะฐั
STT_ENGINE=whisper      # whisper, google, azure, mock
LLM_ENGINE=openai       # openai, deepseek, ollama, mock
TTS_ENGINE=coqui        # coqui, openai, google, mock

# ะขัะป ะฑะฐะฟัะฐัะปะฐัั
DEFAULT_LANGUAGE=kk     # kk (ะบะฐะทะฐา), ru (ะพััั)
STT_WHISPER_LANGUAGE=kk # kk, ru, auto

# าะฐััะฟััะทะดัะบ
RATE_LIMIT_PER_HOUR=5   # ะัั ะฝำฉะผััะดะตะฝ ัะฐาะฐััะฝะฐ าะพาฃััะฐัะปะฐั
MAX_CALL_DURATION=300   # ะะฐะบั าฑะทะฐาััาั (ัะตะบัะฝะด)
```

### Asterisk ะฑะฐะฟัะฐัะปะฐั:

- `extensions.conf` - าะพาฃััะฐั ะผะฐัััััะธะทะฐัะธััั
- `sip.conf` - SIP ะบะปะธะตะฝััะตัั ะผะตะฝ trunk ะฑะฐะฟัะฐัะปะฐัั
- `asterisk.conf` - ะะตะณัะทะณั ะฟะฐัะฐะผะตััะปะตั

## ๐ JSON ะจะซาะฃ ะะะจะะะ

ะะ ำัาะฐัะฐะฝ ะบะตะปะตัั ัะพัะผะฐััะฐ JSON าะฐะนัะฐัะฐะดั:

```json
{
  "urgency": "high",
  "category": "vehicle_theft",
  "address": "ะะฑะฐะน ะบำฉัะตัั 15",
  "current_danger": false,
  "people_involved": 1,
  "weapons": false,
  "recommended_department": "าฑัะปัา ะฑำฉะปัะผั",
  "summary": "ะะฐัะธะฝะฐ าฑัะปะฐะฝะดั, ะบะตัะต ัาฏะฝะดะต, ะฐะดัะตั ะฑะฐั",
  "timestamp": "2025-12-30T10:00:37Z",
  "call_id": "call_20251230_100000_77771234567",
  "confidence_score": 0.92
}
```

**ะขะพะปัา ัะธะฟะฐััะฐะผะฐ:** `docs/JSON_FORMAT.md`

## ๐จ EDGE CASES ำจาขะะะฃ

ะาฏะนะต ะบะตะปะตัั edge cases-ัะฐัะดั ำฉาฃะดะตะนะดั:

1. **าฎะฝััะท าะพาฃััะฐั ัะฐะปััั** - 10 ัะตะบัะฝะดัะฐะฝ ะบะตะนัะฝ ัาฑัะฐา าะพัะดั
2. **ะญะผะพัะธะพะฝะฐะปะดั/ะฐะณัะตััะธะฒัั ัะฐะปััั** - ะกะฐะปาัะฝ าะฐะฝะฐัััะปัาัั ัะฐาัะฐะนะดั
3. **ะขาฏััะฝัะบััะท ัำฉะนะปะตั** - าะฐะนัะฐะปะฐัะดั ัาฑัะฐะนะดั (ะผะฐะบั 3 ัะตั)
4. **ะะตะบะตะฝะถะฐะน ะถะพา** - ะฃัะพัะฝัััะธะต ัาฑัะฐาัะฐั าะพัะดั
5. **ะัะฐะปะฐั ััะปะดะตั** - ะะฐะทะฐา/ะพััั ััะปะดะตััะฝ ะฐะถััะฐัะฐะดั

**ะขะพะปัา ะฐาะฟะฐัะฐั:** `docs/EDGE_CASES.md`

## ๐ าะะฃะะะกะะะะะ

### าะฐััะฟััะทะดัะบ ัะฐัะฐะปะฐัั:

- โ **Rate limiting** - ะัั ะฝำฉะผััะดะตะฝ ัะฐะผะฐะดะฐะฝ ััั าะพาฃััะฐัะปะฐัะดั ัะตะบัะตั
- โ **ะะตัะตะบัะตัะดั ะผะฐัะบะธัะพะฒะบะฐะปะฐั** - ะะตะบะต ะฐาะฟะฐัะฐััั ะถะฐัััั
- โ **ะััะตะฝัะธัะธะบะฐัะธั** - Dashboard าฏััะฝ ะฟะฐัะพะปั าะพัาะฐะฝััั
- โ **ะจะธััะปะฐั** - ะะตัะตะบัะตัะดั ัะฐาัะฐั ะบะตะทัะฝะดะต ัะธััะปะฐั
- โ **Firewall** - ะขะตะบ าะฐะถะตััั ะฟะพัััะฐัะดั ะฐัั
- โ **ะะตะทะตัะฒััะบ ะบำฉัััั** - ะาฏะฝะดะตะปัะบัั ะฝาฑัาะฐะปะฐั

**ะขะพะปัา าะฐััะฟััะทะดัะบ ัะฐััะฐัั:** `docs/SECURITY_AND_LIMITS.md`

## ๐ ะะะะะขะะะะะ ะำะะ ะะกะะะขะะฃ

### ะะพะฝะธัะพัะธะฝะณ าาฑัะฐะปะดะฐัั:

1. **Dashboard:** `http://localhost:5000`
2. **ะะพะณัะฐั:** `/var/log/ai-call-intake/`
3. **ะะฐะทะฐ ะดะฐะฝะฝัั:** `/var/lib/ai-call-intake/calls.db`
4. **Systemd ะถััะฝะฐะปั:** `journalctl -u ai-call-intake -f`

### ะะตะณัะทะณั ะผะตััะธะบะฐะปะฐั:

- าะพาฃััะฐัะปะฐั ัะฐะฝั (ะบาฏะฝะดะตะปัะบัั/ะฐะฟัะฐะปัา/ะฐะนะปัา)
- ะััะฐัะฐ ำฉาฃะดะตั ัะฐาััั
- ะะฐัะตะณะพัะธัะปะฐั ะฑะพะนัะฝัะฐ ะฑำฉะปั
- ะกัะพัะฝะพััั ะฑะพะนัะฝัะฐ ะฑำฉะปั
- าะฐัะตะปะตั ััะฐัะธััะธะบะฐัั

## ๐ ะะะขะะะะะฆะะฏ

### าะพะปะดะฐะฝัััะฐาั ะธะฝัะตะณัะฐัะธัะปะฐั:

- **SIP Trunk** - ะะตะท ะบะตะปะณะตะฝ SIP ะฟัะพะฒะฐะนะดะตัะผะตะฝ
- **OpenAI API** - GPT ะถำะฝะต Whisper าฏััะฝ
- **DeepSeek API** - ะะปััะตัะฝะฐัะธะฒะฐ LLM ัะตััะฝะดะต
- **Telegram Bot** - ะัะบะตัััะปะตั าฏััะฝ

### ะะพัะฟะฐัะปะฐะฝาะฐะฝ ะธะฝัะตะณัะฐัะธัะปะฐั:

- **CRM ะถาฏะนะตะปะตัั** - ะะตัะตะบัะตัะดั ะฐะฒัะพะผะฐััั ัาฏัะดะต ะถัะฑะตัั
- **SMS ัะปัะทะดะตัั** - ะฅะฐะฑะฐัะปะฐะฝะดัััะปะฐั าฏััะฝ
- **ะะตะพะปะพะบะฐัะธั API** - ะะตะบะตะฝะถะฐะนะดั ะฐะฒัะพะผะฐััั ะฐะฝัาัะฐั
- **ะะธะดะตะพ ัะฐะปะดะฐั** - ะะพะปะฐัะฐาัะฐ ะฒะธะดะตะพ าะพาฃััะฐัะปะฐั าฏััะฝ

## ๐ า
