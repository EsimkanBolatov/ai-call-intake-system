# Тестирование AI модуля

## 1. Через фронтенд (CallSimulator)

- Откройте браузер и перейдите по адресу: http://localhost:5173/call-simulator
- В поле "Текст звонка" введите пример: "драка у него оружия"
- Нажмите кнопку "Анализировать"
- Результат появится ниже: категория, приоритет, служба, извлеченная информация.
- Нажмите "Создать обращение", чтобы добавить его в журнал.

## 2. Через API AI модуля (curl)

### Классификация текста:

```bash
curl -X POST http://localhost:8001/classify -H "Content-Type: application/json" -d "{\"text\": \"пожар в доме\", \"enhanced\": false}"
```

Параметр `enhanced: false` использует простой классификатор (ключевые слова). Если `true` и настроен OpenAI, будет использоваться расширенная классификация.

### Транскрипция аудио (если есть файл):

```bash
curl -X POST http://localhost:8001/transcribe -F "audio=@audio.wav" -F "language=ru"
```

## 3. Через бэкенд (создание обращения)

```bash
curl -X POST http://localhost:3000/api/cases/incoming-call -H "Content-Type: application/json" -d "{\"phoneNumber\": \"+77771234567\", \"transcription\": \"драка у него оружия\"}"
```

Ответ содержит созданное обращение с полями `serviceType` и `priority`.

## 4. Проверка здоровья сервисов

- AI модуль: http://localhost:8001/health
- Бэкенд: http://localhost:3000/api/health

## Примеры тестовых текстов:

- "пожар в квартире на улице Ленина 5" – служба: пожарный, приоритет high.
- "ДТП на пересечении улиц Абая и Байтурсынова, есть пострадавшие" – служба: полиция и скорая, приоритет high.
- "болит сердце, нужна скорая" – служба: скорая, приоритет medium.
- "ложный вызов, просто шучу" – должен определить как ложный (is_false_call: true).
- "наводнение в районе центрального рынка" – служба: ЧС, приоритет high.

## Запуск AI модуля вручную

Если модуль не запущен:

```bash
cd ai-module
python main.py
```

Сервис будет доступен на порту 8001.

## Настройка OpenAI (опционально)

Если вы хотите использовать расширенную классификацию через GPT:

1. Убедитесь, что в файле `ai-module/.env` указан корректный `OPENAI_API_KEY`.
2. Установите совместимые версии библиотек (может потребоваться downgrade openai).
3. Перезапустите AI модуль.

При возникновении ошибок проверьте логи AI модуля.
