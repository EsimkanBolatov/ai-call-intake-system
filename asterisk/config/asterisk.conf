; Main Asterisk configuration file for AI Call Intake System

[directories]
astetcdir => /etc/asterisk
astmoddir => /usr/lib/asterisk/modules
astvarlibdir => /var/lib/asterisk
astdbdir => /var/lib/asterisk
astkeydir => /var/lib/asterisk
astdatadir => /var/lib/asterisk
astagidir => /var/lib/asterisk/agi-bin
astspooldir => /var/spool/asterisk
astrundir => /var/run/asterisk
astlogdir => /var/log/asterisk

[options]
verbose = 3
debug = 0
dumpcore = no
highpriority = yes
runuser = asterisk
rungroup = asterisk
defaultlanguage = ru
systemname = ai-call-intake-102

[files]
astctlpermissions = 0660
astctlowner = asterisk
astctlgroup = asterisk
astctl = asterisk.ctl

[compat]
pbx_realtime=1.6
res_agi=1.6
app_queue=1.6

; AGI configuration
[agi]
enabled=yes
ignore_stderr=no

; Set AGI script timeout (in milliseconds)
setvar=AGITIMEOUT=30000

; Enable AGI debugging
debug=no

; Modules to load
[modules]
autoload=yes
noload => chan_skinny.so
noload => chan_alsa.so
noload => chan_console.so
noload => chan_mgcp.so
noload => chan_phone.so
noload => chan_iax2.so    ; disable IAX2 if not needed

; Logging configuration
[logfiles]
console => verbose,notice,warning,error
; Full debug logging for AGI (enable for troubleshooting)
; agi => debug
messages => notice,warning,error

; RTP configuration
[rtp]
rtpstart=10000
rtpend=20000
stunaddr=stun.l.google.com:19302

; Jitterbuffer
[jitterbuffer]
jbenable = yes
jbmaxsize = 200
jbresyncthreshold = 1000
jbimpl = fixed
jblog = no

; Codecs
[codecs]
; Preferred codec order
ulaw=yes
alaw=yes
gsm=yes
g722=no
g726=no
g729=no
speex=no
ilbc=no
opus=no

; SIP settings (overridden by sip.conf)
[sip]
bindport=5060
bindaddr=0.0.0.0
context=incoming
language=ru
relaxdtmf=yes
rtptimeout=60
rtpholdtimeout=300
rtpkeepalive=0

; Features
[features]
parkingtime = 45
parkext = 700
context = parkedcalls
parkpos = 701-720
transfer = yes
blindtransfer = yes
atxfernoanswertimeout = 15

; Voicemail (optional)
[voicemail]
format=wav
maxmessage=300
minmessage=2
maxsilence=10
silencethreshold=128
maxlogins=3
skipms=3000
maxsecs=180

; Music on Hold
[moh]
mode=files
directory=/var/lib/asterisk/moh

; Queues (if needed for operator transfer)
[queues]
persistentmembers=yes
monitor-type=MixMonitor
autopause=yes

; MeetMe conference (optional)
[meetme]
conf => 8600-8699

; AMD (Answering Machine Detection) - optional
[amd]
initialSilence = 2500
greeting = 1500
afterGreetingSilence = 800
totalAnalysisTime = 5000
minWordLength = 100
betweenWordsSilence = 50
maximumNumberOfWords = 3
silenceThreshold = 256